{"version":3,"file":"ng-paste-from-latest.min.js","sources":["ng-paste-from.coffee"],"names":[],"mappings":"CAAA,WAAA,QAAQ,OAAO,kBACb,SAAS,qBACT,oBAAqB,oCACrB,iBAAkB,kCAClB,UAAU,cAAe,kBACzB,SAAU,IACV,OACC,YAAa,IACb,kBAAmB,IACnB,mBAAoB,IACpB,sBAAuB,IACvB,mBAAoB,KAErB,KAAM,SAAC,OAAQ,eACP,OAAA,OAAA,mBACN,QAAQ,MAAM,iDAIf,QAAQ,GAAG,QAAS,iBACnB,SAAQ,IAAI,IACZ,OAAO,WAAY,IAEpB,QAAQ,GAAG,QAAS,iBAChB,QAAO,YACT,OAAO,OAAO,iBACb,QAAO,UAAY,OAAO,mBAAmB,QAAQ,SAEtD,OAAO,WAAY,GAEpB,QAAQ,IAAI,OAEd,WAAY,SAAC,OAAQ,QAAS,mBAC7B,GAAA,iBAAA,eAAA,eAAA,kBAAA,eAAA,kBAAA,gBAAiB,SAAC,YAAS,OAE3B,eAAiB,SAAC,MAAO,aACxB,SAAQ,MAAM,2BAA6B,MAAQ,WAAa,QAEjE,kBAAoB,WACnB,OAAO,GAGD,MAAA,OAAA,qBAAgC,OAAO,mBAAqB,gBAC5D,MAAA,OAAA,qBAAgC,OAAO,mBAAqB,gBAC5D,MAAA,OAAA,wBAAmC,OAAO,sBAAwB,mBAEzE,YAAc,SAAC,MACd,GAAA,YAAA,iBAGA,OAHA,mBAAoB,mBACpB,WAAa,KAEN,KAAK,QAAQ,kBAAmB,YAAY,MAAM,aAE1D,eAAiB,SAAC,KACjB,GAAA,cAEA,OAFA,eAAgB,IAET,IAAI,MAAM,gBAElB,gBAAkB,SAAC,SAClB,GAAA,GAAA,OAAA,EAAA,EAAA,GAAA,IAGA,KAHA,KACA,OAAS,OAAO,kBAEhB,EAAA,GAAA,EAAA,KAAA,QAAA,OAAA,KAAA,GAAA,IAAA,gBACC,EAAE,OAAO,IAAM,CAEhB,OAAO,IAER,OAAO,iBAAmB,SAAC,MAC1B,GAAA,SAAA,EAAA,EAAA,EAAA,OAAA,KAAA,GAAA,IAGA,KAHA,KAAO,YAAY,MACnB,UAEA,EAAA,GAAA,EAAA,KAAA,KAAA,OAAA,KAAA,GAAA,IAAA,aACC,QAAU,eAAe,GAEtB,QAAQ,SAAY,OAAO,kBAAkB,QAIhD,EAAI,gBAAgB,SAEjB,OAAO,sBAAsB,EAAG,GAClC,OAAO,KAAK,GAEZ,OAAO,mBAAmB,kBAAkB,iBAAkB,IAR9D,OAAO,mBAAmB,kBAAkB,oBAAqB,SAUnE,QAAO,YAAc,QAEtB,OAAO,OAAO,YAAa,WAC1B,MAAG,OAAA,OAAA,WAAsB,EAAI,OAAO,UAAU,QAC7C,OAAO,iBAAiB,OAAO,WAC/B,OAAO,UAAY,MAFpB","sourcesContent":["angular.module \"ngPasteFrom\", []\n\t.constant \"ngPasteFromErrors\",\n\t\tinvalidColumnLength: \"NGPASTEFROM_INVALID_COLUMN_LENGTH\"\n\t\tfailedValidation: \"NGPASTEFROM_FAILED_VALIDATION\"\n\t.directive \"ngPasteFrom\", ->\n\t\trestrict: \"A\"\n\t\tscope: \n\t\t\tngPasteFrom: \"=\"\n\t\t\tngPasteFromFormat: \"=\"\n\t\t\tngPasteFromOnPaste: \"=\"\n\t\t\tngPasteFromOnValidate: \"=\"\n\t\t\tngPasteFromOnError: \"=\"\n\t\t\n\t\tlink: ($scope, element, attrs) ->\n\t\t\tif not $scope.ngPasteFromFormat?\n\t\t\t\tconsole.error \"Missing required attribute ngPasteFromFormat.\"\n\n\t\t\t# NOTE: This solution with paste + keyup kind of works, but it is not optimal.\n\t\t\t# It causes the data to show and not get processed until key up.\n\t\t\telement.on \"paste\", (event) ->\n\t\t\t\telement.val(\"\")\n\t\t\t\t$scope.hasPasted = true\n\t\t\t\n\t\t\telement.on \"keyup\", (event) ->\n\t\t\t\tif $scope.hasPasted\n\t\t\t\t\t$scope.$apply ->\n\t\t\t\t\t\t$scope.pasteData = $scope.ngPasteFromOnPaste element.val()\n\t\t\t\t\t\n\t\t\t\t\t$scope.hasPasted = false\n\n\t\t\t\telement.val(\"\")\n\t\t\t\n\t\tcontroller: ($scope, $filter, ngPasteFromErrors) ->\n\t\t\tdefaultOnPaste = (data) -> data\n\n\t\t\tdefaultOnError = (error, index) ->\n\t\t\t\tconsole.error \"ngPasteFromError: index \" + index + \" error: \" + error\n\n\t\t\tdefaultOnValidate = (object, index) ->\n\t\t\t\treturn true\n\n\t\t\t# Assign default callbacks\n\t\t\tif not $scope.ngPasteFromOnPaste? then $scope.ngPasteFromOnPaste = defaultOnPaste\n\t\t\tif not $scope.ngPasteFromOnError? then $scope.ngPasteFromOnError = defaultOnError\n\t\t\tif not $scope.ngPasteFromOnValidate? then $scope.ngPasteFromOnValidate = defaultOnValidate\n\n\t\t\tsplitToRows = (data) ->\n\t\t\t\tlineEndingsRegExp = /\\r\\n|\\n\\r|\\n|\\r/g;\n\t\t\t\tlineEnding = \"\\n\"\n\n\t\t\t\treturn data.replace(lineEndingsRegExp, lineEnding).split(lineEnding)\n\n\t\t\tsplitToColumns = (row) ->\n\t\t\t\tseparatorChar = \"\\t\"\n\n\t\t\t\treturn row.split(separatorChar)\n\n\t\t\tcolumnsToObject = (columns) ->\n\t\t\t\to = {}\n\t\t\t\tformat = $scope.ngPasteFromFormat\n\n\t\t\t\tfor c, i in columns\n\t\t\t\t\to[format[i]] = c\n\n\t\t\t\treturn o\n\n\t\t\t$scope.processPasteData = (data) ->\n\t\t\t\trows = splitToRows data\n\t\t\t\tresult = []\n\n\t\t\t\tfor r, i in rows\n\t\t\t\t\tcolumns = splitToColumns r\n\n\t\t\t\t\tif columns.length isnt $scope.ngPasteFromFormat.length\n\t\t\t\t\t\t$scope.ngPasteFromOnError ngPasteFromErrors.invalidColumnLength, i\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t\to = columnsToObject columns\n\n\t\t\t\t\tif $scope.ngPasteFromOnValidate o, i\n\t\t\t\t\t\tresult.push o\n\t\t\t\t\telse\n\t\t\t\t\t\t$scope.ngPasteFromOnError ngPasteFromErrors.failedValidation, i\n\n\t\t\t\t$scope.ngPasteFrom = result\n\n\t\t\t$scope.$watch \"pasteData\", ->\n\t\t\t\tif $scope.pasteData? and 0 < $scope.pasteData.length\n\t\t\t\t\t$scope.processPasteData($scope.pasteData)\n\t\t\t\t\t$scope.pasteData = null\n"],"sourceRoot":"/source/"}