{"version":3,"sources":["ng-paste-from.coffee"],"names":[],"mappings":"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","file":"ng-paste-from-latest.js","sourceRoot":"/source/","sourcesContent":["angular.module \"ngPasteFrom\", []\n\t.constant \"ngPasteFromErrors\",\n\t\tinvalidColumnLength: \"NGPASTEFROM_INVALID_COLUMN_LENGTH\"\n\t\tfailedValidation: \"NGPASTEFROM_FAILED_VALIDATION\"\n\n\t.directive \"ngPasteFrom\", ->\n\t\trestrict: \"A\"\n\t\tscope: \n\t\t\tngPasteFrom: \"=\"\n\t\t\tngPasteFromFormat: \"=\"\n\t\t\tngPasteFromOnPaste: \"=\"\n\t\t\tngPasteFromOnValidate: \"=\"\n\t\t\tngPasteFromOnError: \"=\"\n\n\t\tlink: ($scope, element, attrs) ->\n\t\t\tif not $scope.ngPasteFromFormat?\n\t\t\t\tconsole.error \"Missing required attribute ngPasteFromFormat.\"\n\n\t\t\t# NOTE: This solution with paste + keyup kind of works, but it is not optimal.\n\t\t\t# It causes the data to show and not get processed until key up.\n\t\t\telement.on \"paste\", ->\n\t\t\t\telement.val \"\"\n\t\t\t\t$scope.hasPasted = true\n\n\t\t\telement.on \"keyup\", ->\n\t\t\t\tif $scope.hasPasted\n\t\t\t\t\tpasteData = element.val()\n\t\t\t\t\tif typeof $scope.ngPasteFromOnPaste is \"function\"\n\t\t\t\t\t\tpasteData = $scope.ngPasteFromOnPaste pasteData\n\t\t\t\t\t$scope.$apply ->\n\t\t\t\t\t\t$scope.pasteData = pasteData\n\t\t\t\t\t$scope.hasPasted = false\n\t\t\t\telement.val \"\"\n\n\t\tcontroller: ($scope, $filter, ngPasteFromErrors) ->\n\t\t\tsplitToRows = (data) ->\n\t\t\t\tlineEndingsRegExp = /\\r\\n|\\n\\r|\\n|\\r/g;\n\t\t\t\tlineEnding = \"\\n\"\n\t\t\t\tdata.replace(lineEndingsRegExp, lineEnding).split(lineEnding)\n\n\t\t\tsplitToColumns = (row) ->\n\t\t\t\tseparatorChar = \"\\t\"\n\t\t\t\trow.split separatorChar\n\n\t\t\tcolumnsToObject = (columns) ->\n\t\t\t\tobj = {}\n\t\t\t\tformat = $scope.ngPasteFromFormat\n\t\t\t\tfor column, index in columns\n\t\t\t\t\tobj[format[index]] = column\n\t\t\t\tobj\n\n\t\t\t$scope.processPasteData = (data) ->\n\t\t\t\trows = splitToRows data\n\t\t\t\tresult = []\n\n\t\t\t\tfor row, index in rows\n\t\t\t\t\tcolumns = splitToColumns row\n\n\t\t\t\t\tif columns.length isnt $scope.ngPasteFromFormat.length\n\t\t\t\t\t\tif typeof $scope.ngPasteFromOnError is \"function\"\n\t\t\t\t\t\t\t$scope.ngPasteFromOnError ngPasteFromErrors.invalidColumnLength, index\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t\tobj = columnsToObject columns\n\n\t\t\t\t\tif typeof $scope.ngPasteFromOnValidate isnt \"function\" or $scope.ngPasteFromOnValidate obj, index\n\t\t\t\t\t\tresult.push obj\n\t\t\t\t\telse if typeof $scope.ngPasteFromOnError is \"function\"\n\t\t\t\t\t\t$scope.ngPasteFromOnError ngPasteFromErrors.failedValidation, index\n\n\t\t\t\t$scope.ngPasteFrom = result\n\n\t\t\t$scope.$watch \"pasteData\", ->\n\t\t\t\tif $scope.pasteData? and 0 < $scope.pasteData.length\n\t\t\t\t\t$scope.processPasteData($scope.pasteData)\n\t\t\t\t\t$scope.pasteData = null\n"]}